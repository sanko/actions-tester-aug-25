name: Nested Greeting Workflow

on:
  workflow_dispatch:

jobs:
  run-by-os:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    name: "OS: ${{ matrix.os }}"
    uses: ./.github/workflows/workflow-a.yml
    with:
      os: ${{ matrix.os }}

  # This job will now be syntactically valid, but its logic for checking status
  # from a nested matrix will still not work as intended.
  # A full solution would require a different approach.
  CheckAlexStatus:
    needs: run-by-os
    if: always()
    runs-on: ubuntu-latest
    outputs:
      all_alex_passed: ${{ steps.check.outputs.all_alex_passed }}
    steps:
      - name: Check Alex's job statuses
        id: check
        run: |
          echo "This part of the workflow requires refactoring to correctly check status from a nested matrix."
          echo "all_alex_passed=false" >> "$GITHUB_OUTPUT"

  StageAfterAlex:
    needs: CheckAlexStatus
    runs-on: ubuntu-latest
    if: needs.CheckAlexStatus.outputs.all_alex_passed == 'true'
    steps:
      - name: All Alex jobs passed
        run: echo "All jobs with name 'Alex' passed. Proceeding with the next stage."
